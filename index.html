<!DOCTYPE html>
<html lang="en" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="./asstes/styles/index.css">
  <title>Document</title>
</head>

<body>
  <div class="container">
    <div class="btn-wrapper">
      <button value="1" id="song" onclick="play('song')">سنگ</button>
      <button value="2" id="paper" onclick="play('paper')">کاغذ</button>
      <button value="3" id="scissors" onclick="play('scissors')">قیچی</button>

      <label>انتخاب کامپیوتر : </label>
      <div id="computerChoice"></div>
      <br />
      <label>تعداد دفعات برنده شدن یوزر : </label>
      <div id="winUserCounter"></div>
      <br />
      <label>تعداد دفعات برنده شدن کامپیوتر : </label>
      <div id="winComputerCounter"></div>
      <br />
      <label>برنده نهایی : </label>
      <div id="winner"></div>
    </div>
  </div>
</body>
<script>
  let counter = 0;
  let winUserCounter = 0;
  let winComputerCounter = 0;

  const gameOptions = {
    song: 1,
    paper: 2,
    scissors: 3,
  };

  const gameOptionsFa = {
    song: 'سنگ',
    paper: 'کاغذ',
    scissors: 'قیچی',
  };

  const play = (input) => {
    if (checkCounter()) {
      const computerchoice = getRandomBetween();
      document.getElementById("computerChoice").innerText =
        getComputerChoice(computerchoice);
      if (gameOptions[input] === computerchoice) {
        alert("انتخاب ها مشابه بود لطفا دوباره تلاش کنید");
      } else {
        if (gameOptions[input] === gameOptions.song) {
          computerchoice === gameOptions.paper
            ? ++winComputerCounter
            : ++winUserCounter;
        } else if (gameOptions[input] === gameOptions.paper) {
          computerchoice === gameOptions.scissors
            ? ++winComputerCounter
            : ++winUserCounter;
        } else {
          computerchoice === gameOptions.song
            ? ++winComputerCounter
            : ++winUserCounter;
        }
        // console.log("winComputerCounter = " + winComputerCounter);
        // console.log("winUserCounter = " + winUserCounter);
      }
      //یه انیمیشن بذارم و برنده رو توش اعلام کنم
      showResult();
    } else {
      let winner = null;
      if (winUserCounter === winComputerCounter) winner = "مساوی";
      else winner = winUserCounter > winComputerCounter ? "یوزر" : "کامپیوتر";
      alert(
        "تعداد دفعات  مجاز برای بازی به اتمام رسیده است. برنده نهایی: " + winner + "  لطفا دوباه بازی کنید"
      );
      reset();
    }
  };

  const getRandomBetween = () => {
    const num = Math.floor(Math.random() * 3) + 1;
    return num;
  };

  const getComputerChoice = (value) => {
    console.log(value)
    return Object.keys(gameOptions).filter((key) =>
      gameOptions[key] === value
    ).map((choiceEn) => gameOptionsFa[choiceEn]);
  };

  const checkCounter = () => {
    ++counter;
    return counter < 6 ? true : false;
  };

  const showResult = () => {
    document.getElementById("winUserCounter").innerText = winUserCounter;
    document.getElementById("winComputerCounter").innerText =
      winComputerCounter;
    if (winUserCounter === winComputerCounter)
      document.getElementById("winner").innerText = "مساوی";
    else
      document.getElementById("winner").innerText =
        winUserCounter > winComputerCounter ? "یوزر" : "کامپیوتر";
  };

  const reset = () => {
    counter = 0;
    winUserCounter = 0;
    winComputerCounter = 0;
    document.getElementById("computerChoice").innerText = "";
    document.getElementById("winUserCounter").innerText = "";
    document.getElementById("winComputerCounter").innerText = "";
    document.getElementById("winner").innerText = "";
  };
</script>

</html>